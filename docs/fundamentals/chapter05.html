<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">APIs and Access | CKA Prep</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/cka-prep/docs/fundamentals/chapter05"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="APIs and Access | CKA Prep"><meta data-react-helmet="true" name="description" content="Course Reading"><meta data-react-helmet="true" property="og:description" content="Course Reading"><link data-react-helmet="true" rel="icon" href="/cka-prep/img/k8s.png"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/cka-prep/docs/fundamentals/chapter05"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/cka-prep/docs/fundamentals/chapter05" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/cka-prep/docs/fundamentals/chapter05" hreflang="x-default"><link rel="stylesheet" href="/cka-prep/assets/css/styles.50115643.css">
<link rel="preload" href="/cka-prep/assets/js/runtime~main.8c6a952a.js" as="script">
<link rel="preload" href="/cka-prep/assets/js/main.b2e2e5cd.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cka-prep/"><div class="navbar__logo"><img src="/cka-prep/img/kubernetes-icon.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/cka-prep/img/kubernetes-icon.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">CKA Prep</b></a><a class="navbar__item navbar__link navbar__link--active" href="/cka-prep/docs/intro">Notes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/andrewdaoust/cka-prep" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cka-prep/docs/intro">Kubernetes Resources</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_VCh3" aria-current="page" href="/cka-prep/docs/fundamentals">Kubernetes Fundamentals</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Fundamentals&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter01">Course Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter02">Basics of Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter03">Installation and Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter04">Kubernetes Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cka-prep/docs/fundamentals/chapter05">APIs and Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter06">API Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter07">Managing State with Deployments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter08">Volumes and Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter09">Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter10">Helm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter11">Ingress</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter12">Scheduling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter13">Logging and Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter14">Custom Resource Definitions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter15">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter16">High Availability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/chapter17">Exam Domain Review</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cka-prep/docs/fundamentals/follow-up">Follow-up Items</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/cka-prep/docs/kubectl/setup">kubectl</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/cka-prep/docs/hard-way/about">Kubernetes the Hard Way</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/cka-prep/docs/linux">Linux</a><button aria-label="Toggle the collapsible sidebar category &#x27;Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/cka-prep/docs/misc">Miscellaneous Topics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Miscellaneous Topics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>APIs and Access</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="course-reading">Course Reading<a class="hash-link" href="#course-reading" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="learning-objectives">Learning objectives<a class="hash-link" href="#learning-objectives" title="Direct link to heading">â€‹</a></h3><ul><li>Understand the API REST based architecture</li><li>Work with annotations</li><li>Understanding simple pod templates</li><li>Using <code>kubectl</code> with greater verbosity to troubleshoot</li><li>Separating cluster resources using namespacing</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="api-access">API access<a class="hash-link" href="#api-access" title="Direct link to heading">â€‹</a></h3><p>Kubernetes has a powerful REST API that is the heart of it&#x27;s architecture.  Knowing how to find the endpoints for resources and understanding how the API changes between versions is vitally important for administrative tasks.  Starting at v1.16, the API no longer honors depreciated objects.</p><p>As was discusses in <a href="/cka-prep/docs/fundamentals/chapter04">the last section</a> the <strong>kube-apiserver</strong> is the main agent for communication within and outside the cluster.  A <code>curl</code> query to the API will expose current groups.  These groups can have different versions which mature independently of one another. They follow a domain name format, with many reserved such as single word domains, the empty group, and anything with a <code>.k8s.io</code> ending.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="restful">RESTful<a class="hash-link" href="#restful" title="Direct link to heading">â€‹</a></h3><p><code>kubectl</code> work through making API calls for you through typical HTTP verbs.  You could also interact with the cluster externally using <code>curl</code> as long as you pass the appropriate certs and keys.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --cert userbob.pem --key userBob-key.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cacert /path/to/ca.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://k8sServer:6443/api/v1/pods</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Thi ability to impersonate other users/groups allows for manual override of authentication which can be useful in debugging authorization policies for other groups of users.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="checking-access">Checking access<a class="hash-link" href="#checking-access" title="Direct link to heading">â€‹</a></h3><p>Security will be discussed later but for now, it can be helpful to check current authorization of both administrators as well as other users.  Here are some examples:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl auth can-i create deployments</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Using the <code>auth can-i</code> subcommand we can check for what functionality a user has. In this case we would be checking if the user issuing the command with <code>kubectl</code> can create deployments in the <code>default</code> namespace. The API will return with a <code>yes</code> or <code>no</code>.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl auth can-i create deployments --as bob</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This time around we are checking if the user <code>bob</code>, by passing the username with the <code>--as</code> flag, can create deployments in the <code>default</code> namespace.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl auth can-i create deployments --as bob  --namespace developer</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Again we check if the user <code>bob</code> can create deployments, this time in the <code>developer</code> namespace by also passing the <code>--namespace</code> flag.</p><p>Currently, there are three APIs that can be applied to set who/what can be queried:</p><ul><li><code>SelfSubjectAccessReview</code> - Access review for any user, helpful for delegating to others</li><li><code>LocalSubjectReview</code> - Review is restricted to a namespace</li><li><code>SelfSubjectRulesReview</code> - A review showing allowed actions for a user withing a particular namespace</li></ul><p>You can also use </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl auth reconcile -f </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">YAML file</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>to check to see if the necessary permissions exist to create the object specified in the file.  No output indicates the creation is allowed.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="optimistic-currency">Optimistic currency<a class="hash-link" href="#optimistic-currency" title="Direct link to heading">â€‹</a></h3><p>API calls to Kubernetes must use the default serialization of JSON.  There are experimental features that use Google&#x27;s protobuf serialization.  Even though we often work in YAML files, they are converted to and from JSON fr the API calls.</p><p>Kubernetes uses <code>resourceVersion</code> to determine API updates and implement optimistic currency., i.e. objects do not get locked from read time to write time of the object.  Kubernetes handles this by first checking the <code>resourceVersion</code> and if the number has been changed a <code>409 CONFLICT</code> error is returned.  The <code>resourceVersion</code> is backed by the <code>modifiedIndex</code> parameter in etcd.  It is unique to the namespace, kind, and server.  Any operations that do not change an object do not change the <code>resourceVersion</code>, for example <code>WATCH</code> and <code>GET</code>s.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="using-annotations">Using annotations<a class="hash-link" href="#using-annotations" title="Direct link to heading">â€‹</a></h3><p>In Kubernetes labels are used to work with object or collections of objects.</p><p>Annotations on the other hand serve as a way to add metadata to objects that is useful outside of Kubernetes.  Similar to labels, they are key-value pairs.  They also can hold more information and information that is more human readable than labels.</p><p>Some use cases of annotations:</p><ul><li>Timestamps</li><li>Pointer to related objects in other ecosystems, e.g. a link to view logging externally or to a repo containing the source code of the object</li><li>Developer email who created object</li><li>Friendly description of object</li></ul><p>Any of the uses for annotations is information that could sit elsewhere in some other database but allowing for them increases flexibility and allows for better integration of management and deployment tools.</p><p>Some examples of how to annotate Pods in a namespace, overwrite it for a Pod, and then delete the annotation on that Pod:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl annotate pods --all </span><span class="token assign-left variable" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Production Pods&#x27;</span><span class="token plain"> -n prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl annotate --overwrite pod webpod </span><span class="token assign-left variable" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Old Production Pods&quot;</span><span class="token plain"> -n prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl -n prod annotate pod webpod description-</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="simple-pod">Simple pod<a class="hash-link" href="#simple-pod" title="Direct link to heading">â€‹</a></h3><p>Remember that a Pod is the smallest object we can work with in Kubernetes.  A pod can contain a single container, or multiple, often with the primary application container and some number of supporting ones.</p><p>Here is an example of a simple YAML Pod manifest:</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> firstpod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> stan</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Notice the <code>apiVersion</code>, which is how Kubernetes tracks the <em>optimistic currency</em>. There is also the <code>kind</code> field to specify which kind of object is being defined in the manifest.  Then there is the <code>metadata</code> field to define any metadata for thr Pod with at least a <code>name</code>. Here is where you can add <code>labels</code> and <code>annotations</code> as well.  Finally is the <code>spec</code> field where you define what will run and any parameters. This contains any definitions for <code>containers</code> that the Pod will contain, among some other possible definitions.</p><p><code>kubectl create</code> can be used to create Pods in Kubernetes.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create -f simple.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pod firstpod -o yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pod firstpod -o json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Once the deployment is created, you can check its status with the <code>get pods</code> sub commands and list the Pod definitions to the terminal with <code>get pods &lt;pod name&gt; -o &lt;format&gt;</code>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="manage-api-resources-with-kubectl">Manage API resources with <code>kubectl</code><a class="hash-link" href="#manage-api-resources-with-kubectl" title="Direct link to heading">â€‹</a></h3><p>All objects in Kubernetes are exposed via RESTful API calls so that they can be managed with HTTP, JSON, or XML (although typically it is HTTP).  Object states can be changed with the standard HTTP verbs.</p><p><code>kubectl</code> exposes information for the REST calls it is making if you increase the verbosity.  This will include additional logging like the <code>curl</code> commands being made behind the scenes. Max verbosity is <code>10</code>.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --v</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> get pods firstpod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --v</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> delete pods firstpod</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>If you ran the first command above, you would see the HTTP method as <code>XGET</code> and when running the second you would see it change to <code>XDELETE</code>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="access-from-outside-the-cluster">Access from outside the cluster<a class="hash-link" href="#access-from-outside-the-cluster" title="Direct link to heading">â€‹</a></h3><p>Instead of using <code>kubectl</code> you could use <code>curl</code> to make changes to the cluster.</p><p>The basic server configuration (with omitted TLS cert info) can be found using </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config view</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Running this command will show config pulled from <code>~/.kube/config</code>.  In the <a href="/cka-prep/docs/fundamentals/chapter05#manage-api-resources-with-kubectl">previous section</a>, if you ran the command with additional verbosity, you&#x27;d see something like <code>Config loaded from file ~/.kube/config</code> in the logging.</p><p>Without the cert authority, key, and cert from the kube config file, only insecure <code>curl</code> commands would work, which severely limits how much you can interact with the cluster.  In the upcoming lab we will use <code>curl</code> and TLS to access the cluster.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="kubeconfig"><code>~/.kube/config</code><a class="hash-link" href="#kubeconfig" title="Direct link to heading">â€‹</a></h3><p>Here&#x27;s an example of a section of a <code>~/.kube/config</code> file:</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">clusters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">certificate-authority-data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> LS0tLS1CRUdF</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//10.128.0.3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">6443 ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">contexts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">context</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">admin@kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">current-context</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">admin@kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">preferences</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">users</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">client-certificate-data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> LS0tLS1CRUdJTib</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">client-key-data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> LS0tLS1CRUdJTi</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Here is what each major section is.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="apiversion"><code>apiVersion</code><a class="hash-link" href="#apiversion" title="Direct link to heading">â€‹</a></h4><p>Similar to other objects in Kubernetes, this field instructs the kube-apiserver where to assign the data.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="clusters"><code>clusters</code><a class="hash-link" href="#clusters" title="Direct link to heading">â€‹</a></h4><p>Contains the name of the cluster and where to send API requests. The sub-field <code>certificate-authority-data</code> is also passed to authenticate requests made by <code>curl</code>.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="contexts"><code>contexts</code><a class="hash-link" href="#contexts" title="Direct link to heading">â€‹</a></h4><p>This field allows for easy access to multiple clusters, and potentially by multiple users, in one configuration file.  It can be used to set the <code>namespace</code>, <code>user</code>, or <code>cluster</code>.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="current-context"><code>current-context</code><a class="hash-link" href="#current-context" title="Direct link to heading">â€‹</a></h4><p>Shows what cluster and user <code>kubectl</code> commands will go to. These can be passed on a per command basis.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="kind"><code>kind</code><a class="hash-link" href="#kind" title="Direct link to heading">â€‹</a></h4><p>Every object in Kubernetes has a <code>kind</code> set. In this case, the <code>kind</code> of object is <code>Config</code>.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="preferences"><code>preferences</code><a class="hash-link" href="#preferences" title="Direct link to heading">â€‹</a></h4><p>Not currently used in the example above, but it can used for optional settings of <code>kubectl</code>, like colorizing outputs.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="users"><code>users</code><a class="hash-link" href="#users" title="Direct link to heading">â€‹</a></h4><p>Nicknames for associated client credentials, such as key and certs, usernames and passwords, or a token.</p><p>A token and username/password are mutually exclusive and can be set up via <code>kubectl config set-credentials</code>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="namespaces">Namespaces<a class="hash-link" href="#namespaces" title="Direct link to heading">â€‹</a></h3><p><em>Namespace</em> is a term used both for the feature of the Linux kernel and Kubernetes the allows for segregation of resources.  In the case of the Linus kernel, it is segregating system resources, while in Kubernetes it is the segregation of API objects.</p><p>Every call to the API includes a namespace, and it uses the <code>default</code> namespace if one is not specified: <code>https://&lt;Cluster IP&gt;:6443/api/v1/namespaces/default/pods</code></p><p>Four namespace are created along with the cluster.</p><ol><li><strong><code>default</code></strong> - Where resources are assumed unless otherwise specified.</li><li><strong><code>kube-node-lease</code></strong> - Namespace for worker node lease information to be stored.</li><li><strong><code>kube-public</code></strong> - Namespace that is readable by all, even ones not authenticated.  General information about the cluster is included in this namespace.</li><li><strong><code>kube-system</code></strong> - Namespace for infrastructure pods.</li></ol><p>If you want to see resources in all namespaces, the <code>--all-namespaces</code> option can be passed with the <code>kubectl</code> command.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="working-with-namespaces">Working with namespaces<a class="hash-link" href="#working-with-namespaces" title="Direct link to heading">â€‹</a></h3><p>You can view the list of namespaces with</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get ns</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>To create a new one you can do</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create ns mynspace</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>You can describe a namespace like other objects</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe ns mynspace</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The config in YAML format for the namespace can be viewed with</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get ns/mynspace -o yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>And you can delete a namespace with</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete ns/mynspace</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Once a namespace is created, it can be referencing in YAML when defining other objects.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> V1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> redis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mynspace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="api-resources-with-kubectl">API resources with <code>kubectl</code><a class="hash-link" href="#api-resources-with-kubectl" title="Direct link to heading">â€‹</a></h3><p>Here is a list of all objects that are exposed by <code>kubectl</code>.  Expect this list to change as Kubernetes continues to mature.</p><ul><li><code>all</code></li><li><code>certificatesigningrequests</code> or <code>csr</code></li><li><code>clusterrolebindings</code></li><li><code>clusterroles</code> which is only available to federation apiservers</li><li><code>componentstatuses</code> or <code>ca</code></li><li><code>configmaps</code> or <code>cm</code></li><li><code>controllerrevisions</code></li><li><code>cronjobs</code></li><li><code>customresourcedefinition</code> or <code>crd</code></li><li><code>daemonsets</code> or <code>ds</code></li><li><code>deployments</code> or <code>deploy</code></li><li><code>endpoints</code> or <code>ep</code></li><li><code>events</code> or <code>ev</code></li><li><code>horizontalpodautoscalers</code> or <code>hpa</code></li><li><code>ingresses</code> or <code>ing</code></li><li><code>jobs</code></li><li><code>limitranges</code> or <code>limits</code></li><li><code>namespaces</code> or <code>ns</code></li><li><code>networkpolicies</code> or <code>netpol</code></li><li><code>node</code> or <code>no</code></li><li><code>persistentvolumeclaims</code> or <code>pvc</code></li><li><code>persistentvolumes</code> or <code>pv</code></li><li><code>poddisruptionbudgets</code> or <code>pdb</code></li><li><code>podpreset</code></li><li><code>pods</code> or <code>po</code></li><li><code>podsecuritypolicies</code> or <code>psp</code></li><li><code>podtemplates</code></li><li><code>replicasets</code> or <code>rs</code></li><li><code>replicationcontrollers</code> or <code>rc</code></li><li><code>resourcequotas</code> or <code>quota</code></li><li><code>rolebindings</code></li><li><code>roles</code></li><li><code>secrets</code></li><li><code>serviceaccounts</code> or <code>sa</code></li><li><code>services</code> or <code>svc</code></li><li><code>statefulsets</code></li><li><code>storageclasses</code></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="additional-resource-methods">Additional resource methods<a class="hash-link" href="#additional-resource-methods" title="Direct link to heading">â€‹</a></h3><p>On top of basic resource management, certain objects have some other extremely helpful endpoints in the API.  For example, the logs of a container, <code>exec</code>ing into a container, or watching for changes.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --cert /tmp/client.pem --key /tmp/client-key.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cacert /tmp/ca.pem -v XGET </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Cluster IP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:6443/api/v1/namespaces/default/pods/firstpod/log</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Equivalently with <code>kubectl</code> would be</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs firstpod</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Some other calls that can be made are</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">GET /api/v1/namespaces/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">namespace</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/pods/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/exec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /api/v1/namespaces/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">namespace</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/pods/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /api/v1/watch/namespaces/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">namespace</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/pods/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="swagger-and-openapi">Swagger and OpenAPI<a class="hash-link" href="#swagger-and-openapi" title="Direct link to heading">â€‹</a></h3><p>The Kubernetes API was built using a Swagger specification. This has been evolving towards the OpenAPI initiative, which is extremely useful so you can autogenerate client code.  All stable resource definitions are in the docs site.  The API groups can be browsed in a Swagger UI on the <a href="https://swagger.io/specification/" target="_blank" rel="noopener noreferrer">OpenAPI specification page</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="api-maturity">API maturity<a class="hash-link" href="#api-maturity" title="Direct link to heading">â€‹</a></h3><p>Using API groups and versions allow development to continue without changes to existing groups and allows for easier growth and splitting work among different teams.</p><p>Use of JSON and Protobuf serialization will follow the same release guidelines.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="alpha">Alpha<a class="hash-link" href="#alpha" title="Direct link to heading">â€‹</a></h4><p>This is denoted with <code>alpha</code> in the version name. These features are often still buggy and disabled by default. These features can also change or altogether disappear without notice. Backward compatibility is not guaranteed either. These features should only be used on test clusters that are rebuilt often.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="beta">Beta<a class="hash-link" href="#beta" title="Direct link to heading">â€‹</a></h4><p>Denoted with <code>beta</code> in the version name.  These features are more well tested and are enabled by default. It also ensures backward compatibility will be tested going forward but hasn&#x27;t been tested and adopted widely enough to be considered stable.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="stable">Stable<a class="hash-link" href="#stable" title="Direct link to heading">â€‹</a></h4><p>Stable releases have no designator, just the version number. Currently, the only stable version is <code>v1</code>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="lab-exercises">Lab Exercises<a class="hash-link" href="#lab-exercises" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="lab-51---configuring-tls-access">Lab 5.1 - Configuring TLS access<a class="hash-link" href="#lab-51---configuring-tls-access" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">â€‹</a></h4><p><code>kubectl</code> makes calls to the Kubernetes API for you, but you could do the same using <code>curl</code> or a golang client with the correct TLS keys. Making calls to the <em>kube-apiserver</em> get or set PodSpec, or desired state. If thr request is a new state the control plane will update the cluster until the desired state is met by the current state.</p><p>API requests must pass their information as JSON. <code>kubectl</code> converts YAML into JSON when making the API request. There are many settings in the API request but there must be the <code>apiVersion</code>, <code>kind</code>, <code>metadata</code>, and <code>spec</code> included to declare what kind of object to create. The <code>spec</code> field depends on the type of object being created.</p><p>First view the <code>kubectl</code> configuration file.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">less</span><span class="token plain"> </span><span class="token environment constant" style="color:#36acaa">$HOME</span><span class="token plain">/.kube/config</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Notice, the <code>certificate-authority-data</code>, <code>client-certificate-data</code> and <code>client-key-data</code> fields in the file.  These are what we want to extract so we can use <code>curl</code> directly to interact with the API.</p><p>Next we will want to extract the keys to variables.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">client</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">grep</span><span class="token variable" style="color:#36acaa"> client-cert </span><span class="token variable environment constant" style="color:#36acaa">$HOME</span><span class="token variable" style="color:#36acaa">/.kube/config </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable function" style="color:#d73a49">cut</span><span class="token variable" style="color:#36acaa"> -d</span><span class="token variable string" style="color:#e3116c">&quot; &quot;</span><span class="token variable" style="color:#36acaa"> -f </span><span class="token variable number" style="color:#36acaa">6</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">key</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">grep</span><span class="token variable" style="color:#36acaa"> client-key-data </span><span class="token variable environment constant" style="color:#36acaa">$HOME</span><span class="token variable" style="color:#36acaa">/.kube/config </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable function" style="color:#d73a49">cut</span><span class="token variable" style="color:#36acaa"> -d </span><span class="token variable string" style="color:#e3116c">&quot; &quot;</span><span class="token variable" style="color:#36acaa"> -f </span><span class="token variable number" style="color:#36acaa">6</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">auth</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">grep</span><span class="token variable" style="color:#36acaa"> certificate-authority-data </span><span class="token variable environment constant" style="color:#36acaa">$HOME</span><span class="token variable" style="color:#36acaa">/.kube/config </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable function" style="color:#d73a49">cut</span><span class="token variable" style="color:#36acaa"> -d </span><span class="token variable string" style="color:#e3116c">&quot; &quot;</span><span class="token variable" style="color:#36acaa"> -f </span><span class="token variable number" style="color:#36acaa">6</span><span class="token variable" style="color:#36acaa">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>You can then write these to the console to make sure they were extracted properly with <code>echo</code> like so:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$client</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$auth</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Then we will decode each of these so we can use them with <code>curl</code>.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$client</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> base64 -d - </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./client.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> base64 -d - </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./client-key.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$auth</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> base64 -d - </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./ca.pem</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>To decode the base64 string, we first write the string to standard output with <code>echo</code>. This is then piped into the <code>base64</code> command in decode mode (<code>-d</code>) taking the input from standard output (by passing <code>-</code>) and then redirect the output to a <code>pem</code> file.</p><p>Next get the API server URL from the config file.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config view </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> server</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now we can use <code>curl</code> to interact with the API.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --cert ./client.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --key ./client-key.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cacert ./ca.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ClusterIP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:6443/api/v1/pods</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>And you should receive a large JSON response. Now create a JSON file to create a new Pod.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> curlpod.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>and it should contain</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Pod&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;apiVersion&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;v1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;metadata&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;curlpod&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;namespace&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;default&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;labels&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;examplepod&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;spec&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;containers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nginx&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;image&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nginx&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;ports&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;containerPort&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now we will send an <code>XPOST</code> with <code>curl</code> to create the Pod with this JSON.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --cert ./client.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --key ./client-key.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cacert ./ca.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ClusterIP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:6443/api/v1/namespaces/default/pods </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -XPOST -H</span><span class="token string" style="color:#e3116c">&#x27;Content-Type: application/json&#x27;</span><span class="token plain"> -d@curlpod.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>You can then verify the pod is <code>Running</code> with </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="lab-52---explore-api-calls">Lab 5.2 - Explore API calls<a class="hash-link" href="#lab-52---explore-api-calls" title="Direct link to heading">â€‹</a></h3><p>Once way to see what commands are doing is with <code>strace</code>.</p><p>To use it, prefix your command with it.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">strace</span><span class="token plain"> kubectl get nodes</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The information is cached, so running the command multiple times may cause some slightly variation to the outputs. Near the end is a call to the <code>openat</code> function. Find the path that is being passed to the function and <code>cd</code> to its parent directory.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token environment constant" style="color:#36acaa">$HOME</span><span class="token plain">/.kube/cache/discovery/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ls</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>You&#x27;ll see the another subdirectory names after the hostname and the port like <code>k8scp_6443</code>. Change into it and list the directories contents and you&#x27;ll see there are more subdirectories with configuration info for Kubernetes.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> k8scp_6443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ls</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>You can list out all the subfiles as well with</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">find</span><span class="token plain"> </span><span class="token builtin class-name">.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now let&#x27;s view the objects in <code>v1</code> of the API.  </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m json.tool v1/serverresources.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>For each object type, or <code>kind</code> you can view the list of <code>verbs</code> or actions that can be used. Under each resource type, you&#x27;ll see if the object has any <code>shortNames</code> which makes using them in the command line easier.</p><p>For example, <code>endpoints</code> resources have a short name of <code>ep</code> so the following commands are equivalent</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get endpoints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get ep</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Notice there are 37 different resource types in the v1 file we are looking at.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m json.tool v1/serverresources.json </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> kind</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Looking in other files you can find some more</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m json.tool apps/v1/serverresources.json </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> kind</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Don&#x27;t forget to delete the <code>curlpod</code> to free up the system resources.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete po curlpod</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="knowledge-check">Knowledge check<a class="hash-link" href="#knowledge-check" title="Direct link to heading">â€‹</a></h2><ul><li>Kubernetes uses a RESTful API-driven architecture, accepting standard HTTP verbs</li><li><strong>Annotations</strong> allow for metadata to be included with an object that may be helpful outside the Kubernetes object interaction</li><li><strong><code>apiVersion</code></strong>, <strong><code>kind</code></strong>, <strong><code>metadata</code></strong>, and <strong><code>spec</code></strong> bust be included in a pod template</li><li><strong><code>--all-namespaces</code></strong> should be appended to commands to affect every namespace with <code>kubectl</code></li><li>Objects are <strong>not</strong> restricted to a single namespace</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/fundamentals/chapter05.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/cka-prep/docs/fundamentals/chapter04"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Kubernetes Architecture</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/cka-prep/docs/fundamentals/chapter06"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">API Objects</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#course-reading" class="table-of-contents__link toc-highlight">Course Reading</a><ul><li><a href="#learning-objectives" class="table-of-contents__link toc-highlight">Learning objectives</a></li><li><a href="#api-access" class="table-of-contents__link toc-highlight">API access</a></li><li><a href="#restful" class="table-of-contents__link toc-highlight">RESTful</a></li><li><a href="#checking-access" class="table-of-contents__link toc-highlight">Checking access</a></li><li><a href="#optimistic-currency" class="table-of-contents__link toc-highlight">Optimistic currency</a></li><li><a href="#using-annotations" class="table-of-contents__link toc-highlight">Using annotations</a></li><li><a href="#simple-pod" class="table-of-contents__link toc-highlight">Simple pod</a></li><li><a href="#manage-api-resources-with-kubectl" class="table-of-contents__link toc-highlight">Manage API resources with <code>kubectl</code></a></li><li><a href="#access-from-outside-the-cluster" class="table-of-contents__link toc-highlight">Access from outside the cluster</a></li><li><a href="#kubeconfig" class="table-of-contents__link toc-highlight"><code>~/.kube/config</code></a></li><li><a href="#namespaces" class="table-of-contents__link toc-highlight">Namespaces</a></li><li><a href="#working-with-namespaces" class="table-of-contents__link toc-highlight">Working with namespaces</a></li><li><a href="#api-resources-with-kubectl" class="table-of-contents__link toc-highlight">API resources with <code>kubectl</code></a></li><li><a href="#additional-resource-methods" class="table-of-contents__link toc-highlight">Additional resource methods</a></li><li><a href="#swagger-and-openapi" class="table-of-contents__link toc-highlight">Swagger and OpenAPI</a></li><li><a href="#api-maturity" class="table-of-contents__link toc-highlight">API maturity</a></li></ul></li><li><a href="#lab-exercises" class="table-of-contents__link toc-highlight">Lab Exercises</a><ul><li><a href="#lab-51---configuring-tls-access" class="table-of-contents__link toc-highlight">Lab 5.1 - Configuring TLS access</a></li><li><a href="#lab-52---explore-api-calls" class="table-of-contents__link toc-highlight">Lab 5.2 - Explore API calls</a></li></ul></li><li><a href="#knowledge-check" class="table-of-contents__link toc-highlight">Knowledge check</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/cka-prep/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/andrewdaoust/cka-prep" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Andrew D'Aoust. Built with Docusaurus.</div></div></div></footer></div>
<script src="/cka-prep/assets/js/runtime~main.8c6a952a.js"></script>
<script src="/cka-prep/assets/js/main.b2e2e5cd.js"></script>
</body>
</html>